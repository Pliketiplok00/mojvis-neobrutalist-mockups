# Maestro Flow: Selector Discovery (TEMPORARY)
#
# Purpose: Dump UI hierarchy at key screens to discover stable selectors.
# This is NOT a screenshot baseline flow. It produces printHierarchy output only.
#
# Navigation rules:
#   - Onboarding steps may use known visible text ("English", "Visitor")
#   - Post-onboarding navigation uses text labels visible from hierarchy
#   - If navigation fails, flow fails (no guessing, no optional post-Home)

appId: com.mojvis.app

---

# ========================================
# STAGE 1: App Launch and First Screen
# ========================================

- clearState

- launchApp:
    clearState: true

# Wait for something to appear
- extendedWaitUntil:
    visible:
      id: ".*"
    timeout: 15000

# HIERARCHY 01: FIRST SCREEN
- printHierarchy

# ========================================
# STAGE 2: Handle Onboarding
# ========================================

# Tap English if visible (language selection)
- extendedWaitUntil:
    visible:
      text: "English"
    timeout: 5000
    optional: true

- tapOn:
    text: "English"
    optional: true

# Tap Visitor if visible (user mode selection)
- extendedWaitUntil:
    visible:
      text: "Visitor"
    timeout: 5000
    optional: true

- tapOn:
    text: "Visitor"
    optional: true

# Wait for Home - "Transport" tile must be visible
- extendedWaitUntil:
    visible:
      text: "Transport"
    timeout: 10000

# ========================================
# STAGE 3: Home Screen
# ========================================

# HIERARCHY 02: HOME
- printHierarchy

# ========================================
# STAGE 4: Navigate to Settings
# ========================================

# Settings must be visible and tappable (NOT optional)
- assertVisible:
    text: "Settings"

- tapOn:
    text: "Settings"

# Wait for Settings screen marker
- extendedWaitUntil:
    visible:
      text: "Push Notifications"
    timeout: 8000

# HIERARCHY 03: SETTINGS
- printHierarchy

# ========================================
# STAGE 5: Return to Home and go to Transport
# ========================================

# Swipe right to go back (iOS gesture)
- swipe:
    direction: RIGHT
    duration: 300

# Wait for Home again
- extendedWaitUntil:
    visible:
      text: "Transport"
    timeout: 8000

# Navigate to Transport (NOT optional)
- assertVisible:
    text: "Transport"

- tapOn:
    text: "Transport"

# Wait for Transport hub - "Sea" should be visible
- extendedWaitUntil:
    visible:
      text: "Sea"
    timeout: 8000

# HIERARCHY 04: TRANSPORT
- printHierarchy
